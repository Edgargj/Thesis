\chapter{Resultados y discusión}
La esencia de esta tesis fue la creación de un programa de cómputo que calcula entalpias de formación de compuestos orgánicos a 298 K a partir de archivos de salida del software Gaussian. En consecuencia, es necesaria una explicación detallada de todo esto. Por lo que he dividido esta descripción en dos secciones;
El algoritmo y su uso para la obtención de resultados.

\section{Algoritmo (diseño del programa)}
La entalpía de formación fue calculada a partir del método de atomización y varias correcciones térmicas de la energía interna. La Física Estadística nos permitió separar la función de partición en un producto de los componentes traslacionales, rotacionales, vibracionales, electrónicas y nucleares, con la finalidad de obtener la función de estado de nuestro interés. Todo ello, culminó en la creación de un programa de cómputo que automatiza el cálculo de entalpias de formación (flujo de trabajo). Además, se produjo una versión cuya arquitectura de software permitirá en un futuro, añadir métodos diferentes a G4 de una manera rápida. El procedimiento general se observa en el siguiente diagrama de flujo.
\newpage
\begin{figure}[hbtp]
\begin{center}
\includegraphics[width=\textwidth]{graphs/diagrama-flujo}
\caption{Diagrama de flujo general}
\end{center}
\end{figure}
\newpage
A continuación, se explica a detalle cada uno de los pasos del diagrama de flujo general junto con un ejemplo. Para esto, se eligió al metanol, que llamaremos desde ahora como molécula X ( Mol.X ).
\begin{figure}[hbtp]
\begin{center}
\includegraphics[scale=1]{graphs/methanol.png}
\caption{Molécula de metanol, utilizada para explicar el diagrama de flujo general del programa.}
\end{center}
\end{figure}

\newpage
\subsection {Paso 1 del diagrama de flujo general}

El programa comienza con el uso del archivo de entrada, que contiene la información necesaria de la molécula para iniciar con la lectura de los datos. Para la \textbf{molécula X}, el archivo de entrada tendrá la siguiente forma:
\begin{lstlisting}
G4
3
-115.651767
-115.647489
1 4
6 1
8 1
0
0
12
322.7598
1058.0227
1094.4693
1175.9092
1389.4710
1487.0775
1495.0437
1513.5228
2980.0300
3023.9572
3106.3296
3831.1143
\end{lstlisting}

%\begin{multicols}{2}
%\begin{enumerate}
%	\item G4
%	\item 3
%	\item -115.651767
% 	\item -115.647489
%	\item 1 4
%	\item 6 1
%	\item 8 1
%	\item 0
%	\item 0
%	\item 12
%	\item 322.7598
%	\item 1058.0227
%	\item 1094.4693
%	\item 1175.9092
%	\item 1389.4710
%	\item 1487.0775
%	\item 1495.0437
%	\item 1513.5228
%	\item 2980.0300
%	\item 3023.9572
%	\item 3106.3296
%	\item 3831.1143
%\end{enumerate}
%\end{multicols}
\newpage
\subsection{Paso 2 del diagrama de flujo general}

Ahora, se leerá el archivo de entrada de la siguiente forma:

\begin{enumerate}
		
	\item Categoría de método. 
	\item Número de especies atómicas.
	\item Energía G4 a 0 K.
	\item Entalpía G4 a 0 K.
	\item Número atómico y número de átomos.
	\item Tipo de molécula (lineal o no lineal).
	\item Modelo de aproximación usada (Nicolaides o Rotor Rígido y Oscilador Armónico).
	\item Número de modos de vibración.
	\item Frecuencias vibracionales de la molécula.
\end{enumerate}

Las líneas 1, 2, 3, 4 y 5 siempre se encargarán de leer la categoría del método, el número de especies atómicas, la energía G4 a 0 K, la entalpía G4 a 0 K, el número atómico y el número de átomos, respectivamente. Mientras que las líneas 6, 7, 8 y 9 no siempre ocuparan el mismo lugar, porque estas, dependen de líneas anteriores. 
\\Por ejemplo, para la \textbf{molécula X}, el número de especies atómicas serán tres: Hidrógeno, Carbono y Oxígeno. En consecuencia, la línea 5 se repetirá tres veces para dichas especies. Después, se leerá el tipo de molécula (lineal o no lineal), posteriormente, el modelo de aproximación usada (Nicolaides o Rotor Rígido y Oscilador Armónico), por último, el número de modos de vibración que influirá en las frecuencias vibracionales de la molécula. Al terminar el proceso de lectura, toda esta información es almacenada en variables específicas del programa. 

 
\subsection{Paso 3 del diagrama de flujo general}

Como tercer paso en el diagrama general se encuentra la determinación del método utilizado, que es indispensable para comenzar con los cálculos. Este programa sólo cuenta con un método, el G4 de Gaussian 09. Hecho esto, el programa tiene la certeza de que datos ocupar para las especies atómicas antes leídas. Aunque el programa tiene únicamente el método G4, es posible incorporar otros métodos de Gaussian (véase el apéndice A).



\subsection{Paso 4 del diagrama de flujo general}

En este paso se realiza el cálculo de la entalpía de atomización a 0 K de la molécula. Aquí se utilizan los valores del método G4 para cada uno de los átomos presentes en la \textbf{molécula X}, la cantidad estequiométrica de estos y la entalpía G4 de la molécula a 0 K. Veáse las ecuaciones \ref{eq:5.1} y \ref{eq:5.2}. Para concluir, se realiza una conversión de unidades de energía (hartree a kJ). Obsérvese las ecuaciones \ref{eq:5.4} y \ref{eq:5.5}.

\begin{equation}
\Delta H^{\circleddash}_{a0}(CH_3OH) = \Delta H^{total}_{0K} (C(^{3}P) + 4H(^{2}S) + O(^{3}S))- \Delta E^{total}_{0K} (CH_{3}OH)
\label{eq:5.1}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{a0}(CH_3OH) = -37.834170 + 4(-0.501420) - 75.045500 -(-115.651767) \: h
\label{eq:5.2}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{a0}(CH_3OH) = -114.885349 + 115.651767 \: h
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{a0}(CH_3OH) = (-0.766417 \:h)(2625.4997480 \:kJ\cdot mol^{-1})
\label{eq:5.4}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{a0}(CH_3OH) = 2012.2276 \:kJ\cdot mol^{-1}
\label{eq:5.5}
\end{equation}
 
\subsection{Paso 5 del diagrama de flujo general}

Hecho lo anterior, se realiza el cálculo de la entalpía de formación a 0 K de la molécula. Nuevamente, se utilizan valores experimentales para cada uno de los átomos presentes en la molécula junto con su cantidad especifica y el valor de la entalpía de atomización a 0 K obtenido anteriormente (ecuaciones \ref{eq:5.6} y \ref{eq:5.7}). Al valor obtenido en este paso se le conoce como \textbf{calor de formación} (ecuación \ref{eq:5.9}). Por último, se realiza una conversión de unidades de energía (kJ a kcal), ver las ecuaciones \ref{eq:5.10} y \ref{eq:5.11}. 

\begin{equation}
\Delta H^{\circleddash}_{f0}(CH_3OH) = \Delta H^{\circleddash}_{f0} (C(^{3}P) + 4H(^{2}S) + O(^{3}S))- \Delta E^{\circleddash}_{f0} (CH_{3}OH)
\label{eq:5.6}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f0}(CH_3OH) = 711.185 + 4(216.03500) + 246.7900 - 2012.2276 \:kJ\cdot mol^{-1}
\label{eq:5.7}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f0}(CH_3OH) = 1822.115 - 2012.2276 \:kJ\cdot mol^{-1}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f0}(CH_3OH) = -190.1126 \:kJ\cdot mol^{-1}
\label{eq:5.9}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f0}(CH_3OH) = (-190.1126 \:kJ\cdot mol^{-1})(0.023888 \:kcal)
\label{eq:5.10}
\end{equation}

\begin{equation}
	\Delta H^{\circleddash}_{f0}(CH_3OH) = -45.41 \:kcal
\label{eq:5.11}
\end{equation}

\newpage
\subsection{Paso 6 del diagrama de flujo general}

El paso 6 se encarga de cuantificar la diferencia entre las  dos cantidades G4 (298 K y 0 K) leídas en el paso 1, ecuaciones \ref{eq:5.12} y \ref{eq:5.13}. Además, se realiza una conversión de unidades de energía (hartree a kJ), ecuaciones \ref{eq:5.14} y \ref{eq:5.15}.

\begin{equation}
\Delta \Delta H^{\circleddash}(CH_3OH) = G4 \:Entalpía - G4 \:(0 K)
\label{eq:5.12}
\end{equation}

\begin{equation}
\Delta \Delta H^{\circleddash}(CH_3OH) = -115.647489 - (-115.651767)\:h
\label{eq:5.13}
\end{equation}

\begin{equation}
\Delta \Delta H^{\circleddash}(CH_3OH) = (0.004278)(2625.4997480 \:kJ\cdot mol^{-1})
\label{eq:5.14}
\end{equation}

\begin{equation}
\Delta \Delta H^{\circleddash}(CH_3OH) = 11.23188\:kJ\cdot mol^{-1}
\label{eq:5.15}
\end{equation}

\newpage
\subsection{Paso 7 del diagrama de flujo general}

En el paso 7 se obtiene el valor de la entalpía de formación a 298 K (sumando el calor de formación, la diferencia de las dos cantidades G4 y restando los incrementos correspondientes para los elementos de la molécula en sus estados estándar), en consecuencia, son usados los valores obtenidos en los pasos 5 y 6 (veáse las ecuaciones \ref{eq:5.16}, \ref{eq:5.17}, \ref{eq:5.18} y \ref{eq:5.19}. Para terminar, se realiza una conversión de unidades de energía de kJ a kcal (ecuaciones \ref{eq:5.20} y \ref{eq:5.21}).

\begin{multline}
\Delta H^{\circleddash}_{f298}(CH_3OH) = \Delta H^{\circleddash}_{f0}(CH_{3}OH) + \Delta \Delta H^{\circleddash} (CH_{3}OH) \\ - (\Delta \Delta H^{\circleddash} (C) + 2 \Delta \Delta H^{\circleddash}(H_{2}) + \frac{1}{2} \Delta \Delta H^{\circleddash}(O_{2}))
\label{eq:5.16}
\end{multline}

\begin{multline}
\Delta H^{\circleddash}_{f298}(CH_3OH) = -190.1126 + 11.23188  \\ - (1.05100 + 2(8.46700) + \frac{1}{2} (8.67000))\:kJ\cdot mol^{-1}
\label{eq:5.17}
\end{multline}

\begin{equation}
\Delta H^{\circleddash}_{f298}(CH_3OH) = -190.1126 + 11.23188 - 22.3265\:kJ\cdot mol^{-1}
\label{eq:5.18}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f298}(CH_3OH) = -201.21\:kJ\cdot mol^{-1}
\label{eq:5.19}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f298}(CH_3OH) = (-201.21 \:kJ\cdot mol^{-1})(0.023888 \:kcal)
\label{eq:5.20}
\end{equation}

\begin{equation}
\Delta H^{\circleddash}_{f298}(CH_3OH) = -48.06 \:kcal
\label{eq:5.21}
\end{equation}

\newpage
\subsection{Paso 8 y 9 del diagrama de flujo general}

Los pasos 8 y 9 son de los más importantes del programa, porque calculan la energía interna (paso 6) a partir de la física estadística. Se inicia con dos sentencias de condición que evalúan parámetros de la molécula, como son:
\begin{enumerate}
	\item Qué tipo de modelo de aproximación usar.
	\item El número de modos de vibración.
	\item Frecuencias vibracionales.
	\item Si es lineal o no lo es.
\end{enumerate}

El tipo de aproximación usada solo puede tener dos valores, 0 y 1. Sí el archivo de entrada de la molécula muestra un valor de 0 significa que será usada la aproximación de Nicolaides (no tomara en cuenta las frecuencias vibraciones de la molécula menores a 260 $cm^{-1}$ y devolverá $\frac{1}{2}$ de $RT$ para la contribución vibracional por cada frecuencia que sea menor a 260 $cm^{-1}$). Y sí el valor es 1, la aproximación del rotor rigido y el oscilador armónico sera usada para los cálculos. 

También existen dos posibles valores en el archivo de entrada para el parámetro de la linealidad de la molécula. Un valor de 1 devolverá un RT en la contribución rotacional, en cambio, sí el valor es 0, el condicional retornará un $\frac{3}{2}$ de $RT$ en la contribución rotacional.

Después, inicia una estructura de control que se repetirá el mismo número de veces que el número de modos de vibración de la molécula, veáse las ecuaciones \ref{eq:5.22} y \ref{eq:5.23}, donde $N$ es el número especies atómicas que existen en la molécula estas ecuaciones son para moléculas lineales o no lineales, respectivamente. 


\begin{equation}
E_v= \sum^{3N-5}_{k} h\nu_k\:(v_k+\frac{1}{2})
\label{eq:5.22}
\end{equation}

\begin{equation}
E_v= \sum^{3N-6}_{k} h\nu_k\:(v_k+\frac{1}{2})
\label{eq:5.23}
\end{equation}

La iteración usa fórmulas que provienen de la termodinámica estadística (ecuacion \ref{eq:5.24}, \ref{eq:5.25} y \ref{eq:5.26}) y permiten calcular la energía interna como una suma de las contribuciones vibracionales, rotacionales, traslacionales y electrónicas (ecuación \ref{eq:5.28}). La contribución traslacional siempre tendrá el valor de $\frac{3}{2} RT$ para cualquier molécula (ecuación \ref{eq:5.26}). Además, se agrega un RT adicional a la energía interna para convertir la energía en entalpía (el llamado término PV, ecuación \ref{eq:5.27}). Cabe aclarar, que el valor obtenido en la primera iteración es acumulativo para los subsecuentes. Concluida la determinación, se devuelve la suma total de la energía interna.

\begin{equation}
[H(T)-H(0)]_{vib}\:=RT \sum_i \left(\frac{h\nu_i}{kT}\right)\left(\frac{e^{\frac{-h\nu_i}{kT}}}{1-e^{\frac{-h\nu_i}{kT}}}\right)
\label{eq:5.24}
\end{equation}

\begin{equation}
[H(T)-H(0)]_{rot}\:=\:\frac{3}{2}RT
\label{eq:5.25}
\end{equation}
	
\begin{equation}
[H(T)-H(0)]_{trans}\:=\:\frac{3}{2}RT
\label{eq:5.26}
\end{equation}

\begin{equation}
PV\:=RT
\label{eq:5.27}
\end{equation}
	
\begin{multline}
[H(298.15)-H(0)]= ...\\ ...=[H(T)-H(0)]_{vib}+[H(T)-H(0)]_{rot}+[H(T)-H(0)]_{trans}+PV
\label{eq:5.28}
\end{multline}


\begin{equation}
[H(298.15)-H(0)]= RT \sum_i \left(\frac{h\nu_i}{kT}\right)\left(\frac{e^{\frac{-h\nu_i}{kT}}}{1-e^{\frac{-h\nu_i}{kT}}}\right)+ \frac{3}{2}RT + \frac{3}{2}RT + RT
\end{equation}


 
\subsection{Paso 10 del diagrama de flujo general}

El paso 10 simplemente remplaza el valor obtenido anteriormente, por el valor calculado en el paso 6 en la determinación de la entalpía de formación a 298 K, es decir, en el paso 7. Para terminar, se hace una conversión de unidades de energía (kJ a kcal).


\subsection{Paso 11 del diagrama de flujo general}
El último paso de diagrama se encarga de devolver los valores calculados anteriormente, imprimiéndolos en la pantalla a través de la línea de comandos de siguiente forma:
%$ ./compute-enthalpy-atG4.x  CH3OH-G4.txt
\begin{lstlisting}
=============================================================
     New calculation of molecular enthalpies of formation

Enthalpies of formation of gaseous atoms at 0 K and thermal 
corrections for elements in their standard state at 298.16 K from:

      NIST-JANAF Thermochemical Tables J. Physics Chem. 
     		Data Monograph 9, 1998, 1-1951.
=============================================================
Heats of formation:
0K          -190.11 kJ mol-1
0K          -45.41 kcal mol-1
Using Nicolaides method:
298K        -201.21 kJ mol-1
298K        -48.06 kcal mol-1
Using G4:
298K        -201.21 kJ mol-1
298K        -48.06 kcal mol-1
=============================================================
\end{lstlisting}

\section{Código}
El lenguaje de programación utilizado para la creación de este programa se conoce como c++. El motivo principal de su uso fue la implementación de una programación orientada a objetos que fragmentó el código en partes independientes, esto, permite reciclar el código para futuros proyectos. A continuación, se explican las diferentes clases que existen en este programa.

\subsection*{Clases}
A continuación, se enlistan los nombres de las clases utilizadas para este programa:
\begin{itemize}
	\item Enthalpyinputdata
	\item Method
	\item EnthalpyG4
	\item Enthalpyoutputdata 
\end{itemize}

\subsection*{Clase Enthalpyinputdata}
Esta clase se encarga de leer los datos (provenientes de Gaussian) del archivo de entrada. Los datos que lee esta clase son:
\begin{itemize}
	\item Tipo de método 
	\item Número de especies atómicas
	\item Energía G4 a 0 K
	\item Entalpía G4 a 0 K
	\item Número atómico y número de átomos 
	\item Tipo de molécula (lineal o no lineal)
	\item Tipo de aproximación usada (Nicolaides o Rotor Rígido y Oscilador Armónico)
	\item Número de modos de vibración
	\item Frecuencias vibracionales de la molécula 
\end{itemize}
La finalidad de esta clase es determinar la información indispensable para comenzar con el cálculo de la entalpía. 

\subsection*{Clase Method}
La clase Method es utilizada para seleccionar el tipo de método que se realizó en Gaussian, y así, devolver valores específicos para los átomos de Hidrógeno, Carbono, Oxígeno, Nitrógeno, Flúor y Azufre.

\subsection*{Clase EnthalpyG4}
La función de esta clase es realizar las operaciones aritméticas para obtener el calor de formación de la molécula, la entalpia de formación a 298 K por el método de atomización y finalmente, la entalpía de formación a 298 K con correcciones en la energía interna. 

\subsection*{Clase Enthalpyoutputdata}
Enthalpyoutputdata es la clase encargada de devolver los valores calculados anteriormente, imprimiéndolos en la pantalla a través de la línea de comandos.

\section{Conjunto de pruebas}


